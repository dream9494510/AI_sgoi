# AI 聊天介面使用說明

## 🚀 快速啟動

### 步驟 1: 安裝依賴

```bash
pip install flask flask-cors google-generativeai
```

### 步驟 2: 啟動後端伺服器

```bash
cd AI
python chat_api.py
```

你會看到：
```
============================================================
AI 聊天 API 伺服器
============================================================
API 端點: http://localhost:5000
  - POST /api/chat    - 聊天
  - POST /api/clear   - 清除記錄
  - GET  /api/health  - 健康檢查
============================================================
```

### 步驟 3: 開啟網頁

在瀏覽器中打開：
```
file:///C:/Users/user/OneDrive/桌面/專題/code/AI/AI.html
```

或者直接雙擊 `AI.html` 檔案

---

## 📁 檔案結構

```
AI/
├── AI.html          ← 前端聊天介面 (直接用瀏覽器開啟)
├── chat_api.py      ← 後端 API 伺服器 (需要先執行)
└── 使用說明.md      ← 本檔案
```

---

## ✨ 功能特色

1. **對話記憶** - AI 會記住之前的對話內容
2. **繁體中文** - 所有回覆都是繁體中文
3. **營養專業** - 專注於飲食管理和營養建議
4. **美觀介面** - 使用 Tailwind CSS 的溫暖配色

---

## 🧪 測試對話記憶

試試以下對話流程：

```
你: 午餐推薦什麼菜？
AI: [推薦番茄炒蛋、青菜等...]

你: 剛才那個番茄炒蛋怎麼做？
AI: [提供食譜步驟...]  ← 這裡會記得你問的是番茄炒蛋！
```

---

## ⚠️ 常見問題

### Q1: 網頁顯示「連線錯誤」？
**A**: 請確認已經執行 `python chat_api.py` 啟動後端伺服器

### Q2: 出現 CORS 錯誤？
**A**: 已經在 `chat_api.py` 中啟用 CORS，應該不會有這個問題

### Q3: 顯示 ModuleNotFoundError？
**A**: 執行 `pip install flask flask-cors google-generativeai`

### Q4: API Key 無效？
**A**: 檢查 `chat_api.py` 中的 API_KEY 是否正確

---

## 🔧 進階設定

### 修改 API 端點

如果後端部署到其他位置，修改 `AI.html` 中的：

```javascript
const API_URL = 'http://localhost:5000/api/chat';
```

改為你的伺服器地址，例如：
```javascript
const API_URL = 'https://your-domain.com/api/chat';
```

### 調整對話記憶長度

修改 `chat_api.py` 中的：

```python
recent = conversation[-6:]  # 保留最近 3 輪(6則訊息)
```

改為：
```python
recent = conversation[-10:]  # 保留最近 5 輪(10則訊息)
```

---

## 📊 API 說明

### POST /api/chat
發送聊天訊息

**請求**:
```json
{
  "message": "午餐推薦什麼菜？",
  "session_id": "user_123"
}
```

**回應**:
```json
{
  "success": true,
  "response": "建議您可以吃番茄炒蛋...",
  "session_id": "user_123"
}
```

### POST /api/clear
清除對話記錄

**請求**:
```json
{
  "session_id": "user_123"
}
```

**回應**:
```json
{
  "success": true,
  "message": "對話記錄已清除"
}
```

---

## 🎯 下一步

- [ ] 部署到雲端 (Vercel, Heroku, etc.)
- [ ] 加入使用者登入功能
- [ ] 整合資料庫儲存對話記錄
- [ ] 加入語音輸入功能
- [ ] 整合到 Flutter App

---

## 📝 技術細節

### 前端技術
- HTML5
- JavaScript (ES6+)
- Tailwind CSS
- Fetch API

### 後端技術
- Python 3.8+
- Flask 2.0+
- Google Gemini AI API
- CORS 支援

### AI 模型
- Google Gemini 2.5 Flash
- 支援繁體中文
- 對話記憶管理

---

**完成! 🎉 享受與 AI 營養師的對話吧!**
